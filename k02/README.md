# 課題2 レポート
学籍番号　氏名 


## 課題
長崎県にある市町村別人口データを読み込み、リスト構造にするプログラムを作成する。

1. 使用するデータ  
長崎県の人口データは、nagasaki.csvに保存されている。
nagasaki.csvには、csv形式で以下のデータが含まれる
- ID
- 県名
- 市町村名
- 人口
- 男性人口
- 女性人口

長崎県の市町村別人口データは、下記に構造体に読み込まれる。
```
typedef struct {
    int id;
    char pref[13];  // UTF-8対応
    char name[19];  // UTF-8対応
    int population;
    int m_population;
    int f_population;
} City;
```

英語版のデータを用意しました。名称は、nagasaki2.csvです。チャレンジ問題2で、一致する文字列が見つからない場合、こちらを利用してください。その場合、main関数内にあるfopenの引数を下記のように変更してください。
```    
fp = fopen("nagasaki2.csv","r");
```


1. 必須問題：実装する関数  
(1) InsertNewNode：必要なメモリを確保し、リストの先頭に新しいデータを挿入する。  
    [入力]
    - City newCity: リストに挿入する市町村のデータ
    - Node* pNext: リストの先頭アドレス  

    [出力]  
    - return値: (リストの先頭に新しいデータを挿入した後の)リストの先頭アドレス

    (2) SearchCityByID: IDをキーとし、リストを検索する。  
    [入力]  
    - Node* pList: リストの先頭アドレス
    - int ID: 検索する市町村のID 
    
    [出力]  
    - return値: IDが合致した場所(先頭を0とする)。IDが一致するデータがない場合は-1。  
    - City* pCity: IDが合致した市町村のデータを入れる

3. 補助関数  
以下の関数はすでに実装されており、利用することができる。  
- PrintCity: 市町村データを出力する
- ReleaseList: リストで確保したメモリを解放する
- PrintList: リストの内容を出力する。

4. チャレンジ問題  
(1) DeleteNodeAt: 任意のノードをリストから削除する(10点)  
CHALLENGE2を有効にしてください。  
    [入力]  
    - Node** ppNode: リストの先頭を指すポインタ変数のアドレス(ポインタのポインタ)  
    - int cn: ノードの位置(先頭のノードを0とする)  
    [出力]  
    - return値: 削除に成功したらSUCCESS、失敗したらERROR  

    (2) SearchCityByName: 市町村を名称で検索する(5点)  
    CHALLENGE1を有効にしてください。  
    [入力]
<<<<<<< HEAD
    - int key: 検索する市町村の名前
    - City arrayCity: 検索対象の都市別人口データ(配列)
    - int size: データの数  
=======
    - Node* pList: リストの先頭アドレス
    - char* cityName: 検索する市町村の名称
>>>>>>> upstream/master

    [出力]  
    - return値: cityNameが合致した場所(先頭を0とする)。cityNameが一致するデータがない場合は-1。
    - City* pCity: IDが合致した市町村のデータを入れる

## ソースコードの説明


必須問題（１）
l.78 新たにデータ領域を確保する。リストpNodeはそのデータ領域の先頭。
l.79 リストpNodeのメンバであるcityに新しいデータnewCityを入れる。
l.81 リストpNodeのポインタであるpNextで次の要素であるpNextを指定する。
l.83 リストInsertNewNodeにpNodeを返す。

必須問題（２）
l.106 新たにデータ領域を確保する。
l.107 pNodeにpListを代入する。
l.108 IDが合致した場所を示すためのint型の変数posを用意する。
l.110 ~ l.120 pNodeがNULLになるまでwhile文を繰り返す。
    l.112 ~ l.116 pNode内の構造体cityのメンバ変数であるidが入力されたデータであるIDと一致するときの処理を以下に示す
        l.114 ポインタ変数pCityの指すアドレスの中身に、pNode内の構造体cityに入っているデータを代入する。
        l.115 関数SearchCityByIDにIDが合致した場所であるposを返す。
    l.118 次のデータをpNodeに入れる。
    l.119 次のデータの場所を指すためにposの値を1増やす。
l.121 while文を満たさなかった時、関数SearchCityByIDに-1を返す。

チャレンジ問題（１）
l.89 カウント用のint型の変数posを宣言する.
l.90 新たなデータ領域pNodeを確保し, pNodeにppNodeを代入する.
l.91 削除を行う一つ前の要素を表すための新たなデータ領域pPrevを確保する.
l.93 ~ l.99 リストの先頭のデータを削除するための処理を行う.
    l.95 2番目のデータをppNodeに保持する.
    l.96 pNodeのメモリを開放する.
    l.98 関数DeleteNodeAtにSUCCESSを返す.
l.100 ~ l.120 リストの2番目以降のデータを削除するための処理を行う.
    l.102 カウンタ変数posを初期化する.
    l.103 ~ l.114 pNodeがNULLになるまでwhile文を繰り返す.
        l.105 ~ l.108 カウンタ変数とノードの位置が一致したとき, while文を抜け出す.
        l.110 pNodeのデータをprevに保持する.
        l.111 次のデータをpNodeに保持する.
        l.113 次のデータの場所を指すためにposの値を1増やす.
    l.116 一つ前のデータであるpPrevのpNextにpNodeのpNextを代入することでポインタの書き換えを行う.
    l.117 pNodeのメモリを開放する.
    l.119 関数DeleteNodeAtにSUCCESSを返す.
l.122 関数DeleteNodeAtにERRORを返す.

チャレンジ問題（２）
l.129 カウント用のint型の変数posを宣言する.
l.130 新たなデータ領域pNodeを確保し, pNodeにpListを代入する.
l.132 ~ l.142 pNodeがNULLになるまでwhile文を繰り返す.
    l.134 ~ l.138 関数strcmpにより文字列比較を行い, 名前が一致した場合, 以下の処理を行う.
        l.136 City型のポインタpCityの中にpNodeのデータcityを格納する.
        l.137 カウンタ変数であるposの値を関数SearchCityByName返す.
    l.140 次のデータをpNodeに保持する.
    l.141 次のデータの場所を指すためにposの値を1増やす.
1.143 while文を満たさなかった時, 関数SearchCityByNameに-1を返す.

## 出力結果

```

42201, 長崎県, 長崎市, 429508, 198716, 230792
42202, 長崎県, 佐世保市, 255439, 120198, 135241
42203, 長崎県, 島原市, 45436, 20999, 24437
42204, 長崎県, 諫早市, 138078, 65029, 73049
42205, 長崎県, 大村市, 92757, 43938, 48819
42207, 長崎県, 平戸市, 31920, 14874, 17046
42208, 長崎県, 松浦市, 23309, 11164, 12145
42209, 長崎県, 対馬市, 31457, 15361, 16096
42210, 長崎県, 壱岐市, 27103, 12860, 14243
42211, 長崎県, 五島市, 37327, 17339, 19988
42212, 長崎県, 西海市, 28691, 14032, 14659
42213, 長崎県, 雲仙市, 44115, 20847, 23268
42214, 長崎県, 南島原市, 46535, 21574, 24961
42307, 長崎県, 長与町, 42548, 20090, 22458
42308, 長崎県, 時津町, 29804, 14326, 15478
42321, 長崎県, 東彼杵町, 8298, 3886, 4412
42322, 長崎県, 川棚町, 14067, 6656, 7411
42323, 長崎県, 波佐見町, 14891, 7079, 7812
42383, 長崎県, 小値賀町, 2560, 1172, 1388
42391, 長崎県, 佐々町, 13626, 6426, 7200
42411, 長崎県, 新上五島町, 19718, 9197, 10521
===== Start Printing =====
42411, 長崎県, 新上五島町, 19718, 9197, 10521
42391, 長崎県, 佐々町, 13626, 6426, 7200
42383, 長崎県, 小値賀町, 2560, 1172, 1388
42323, 長崎県, 波佐見町, 14891, 7079, 7812
42322, 長崎県, 川棚町, 14067, 6656, 7411
42321, 長崎県, 東彼杵町, 8298, 3886, 4412
42308, 長崎県, 時津町, 29804, 14326, 15478
42307, 長崎県, 長与町, 42548, 20090, 22458
42214, 長崎県, 南島原市, 46535, 21574, 24961
42213, 長崎県, 雲仙市, 44115, 20847, 23268
42212, 長崎県, 西海市, 28691, 14032, 14659
42211, 長崎県, 五島市, 37327, 17339, 19988
42210, 長崎県, 壱岐市, 27103, 12860, 14243
42209, 長崎県, 対馬市, 31457, 15361, 16096
42208, 長崎県, 松浦市, 23309, 11164, 12145
42207, 長崎県, 平戸市, 31920, 14874, 17046
42205, 長崎県, 大村市, 92757, 43938, 48819
42204, 長崎県, 諫早市, 138078, 65029, 73049
42203, 長崎県, 島原市, 45436, 20999, 24437
42202, 長崎県, 佐世保市, 255439, 120198, 135241
42201, 長崎県, 長崎市, 429508, 198716, 230792
print list. items = 21
===== Print End =====
City ID?42322
the city was found at 4
42322, 長崎県, 川棚町, 14067, 6656, 7411
City Name?川棚町
the city was found at 4
42322, 長崎県, 川棚町, 14067, 6656, 7411
===== Start Printing =====
42411, 長崎県, 新上五島町, 19718, 9197, 10521
42391, 長崎県, 佐々町, 13626, 6426, 7200
42383, 長崎県, 小値賀町, 2560, 1172, 1388
42323, 長崎県, 波佐見町, 14891, 7079, 7812
42321, 長崎県, 東彼杵町, 8298, 3886, 4412
42308, 長崎県, 時津町, 29804, 14326, 15478
42307, 長崎県, 長与町, 42548, 20090, 22458
42214, 長崎県, 南島原市, 46535, 21574, 24961
42213, 長崎県, 雲仙市, 44115, 20847, 23268
42212, 長崎県, 西海市, 28691, 14032, 14659
42211, 長崎県, 五島市, 37327, 17339, 19988
42210, 長崎県, 壱岐市, 27103, 12860, 14243
42209, 長崎県, 対馬市, 31457, 15361, 16096
42208, 長崎県, 松浦市, 23309, 11164, 12145
42207, 長崎県, 平戸市, 31920, 14874, 17046
42205, 長崎県, 大村市, 92757, 43938, 48819
42204, 長崎県, 諫早市, 138078, 65029, 73049
42203, 長崎県, 島原市, 45436, 20999, 24437
42202, 長崎県, 佐世保市, 255439, 120198, 135241
42201, 長崎県, 長崎市, 429508, 198716, 230792
print list. items = 20
===== Print End =====
free list. items = 20

```

## 修正履歴

l.132, l.138をそれぞれ修正しました.

l.132 条件を見直しました.
l.138 break文を挿入しました.